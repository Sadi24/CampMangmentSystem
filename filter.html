<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>صفحة الفلاتر</title>
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#f7f9fc;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .card-filter{border-radius:12px}
    table th, table td{text-align:center}
    .rtl .form-control{direction:rtl}
  </style>
</head>
<body class="p-4 rtl">
  <div class="container">
    <header class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h4">لوحة الفلاتر</h1>
      <div>
        <button id="resetBtn" class="btn btn-outline-secondary">إعادة تعيين</button>
        <button id="exportBtn" class="btn btn-primary">تصدير CSV</button>
      </div>
    </header>

    <div class="row g-3 mb-4">
      <div class="col-12 col-lg-4">
        <div class="card p-3 card-filter">
          <h5 class="mb-3">عناصر الفلترة</h5>
          <div class="mb-2">
            <label class="form-label">بحث نصي</label>
            <input id="q" class="form-control" placeholder="ابحث بالاسم أو الوصف...">
          </div>

          <div class="mb-2">
            <label class="form-label">التصنيف</label>
            <select id="category" class="form-select">
              <option value="">الكل</option>
              <option value="A">التصنيف A</option>
              <option value="B">التصنيف B</option>
              <option value="C">التصنيف C</option>
            </select>
          </div>

          <div class="mb-2">
            <label class="form-label d-block">الحالة</label>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="checkbox" id="st1" value="active" checked>
              <label class="form-check-label" for="st1">فعال</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="checkbox" id="st2" value="inactive" checked>
              <label class="form-check-label" for="st2">غير فعال</label>
            </div>
          </div>

          <div class="mb-2">
            <label class="form-label">نطاق التاريخ</label>
            <div class="d-flex gap-2">
              <input id="fromDate" type="date" class="form-control">
              <input id="toDate" type="date" class="form-control">
            </div>
          </div>

          <div class="mb-2">
            <label class="form-label">سعر (من - إلى)</label>
            <div class="d-flex gap-2">
              <input id="minPrice" type="number" class="form-control" placeholder="من">
              <input id="maxPrice" type="number" class="form-control" placeholder="إلى">
            </div>
          </div>

          <div class="mt-3 d-flex gap-2">
            <button id="applyBtn" class="btn btn-success flex-grow-1">تطبيق الفلاتر</button>
            <button id="clearBtn" class="btn btn-outline-danger">مسح</button>
          </div>
        </div>
      </div>

      <div class="col-12 col-lg-8">
        <div class="card p-3">
          <h5 class="mb-3">النتائج (<span id="count">0</span>)</h5>
          <div class="table-responsive">
            <table id="results" class="table table-striped table-bordered align-middle">
              <thead class="table-light">
                <tr>
                  <th>#</th>
                  <th>الاسم</th>
                  <th>التصنيف</th>
                  <th>الحالة</th>
                  <th>تاريخ</th>
                  <th>السعر</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-muted small">تم الإنشاء تلقائياً - عدّل البيانات في السكريبت لتناسبك</footer>
  </div>

  <script>
    // بيانات تجريبية - غيّرها حسب حاجتك أو احضرها من API
    const data = [
      {id:1,name:'منتج أول',category:'A',status:'active',date:'2025-11-20',price:120},
      {id:2,name:'عينة ب',category:'B',status:'inactive',date:'2025-10-05',price:60},
      {id:3,name:'خدمة ج',category:'A',status:'active',date:'2025-12-01',price:300},
      {id:4,name:'مادة د',category:'C',status:'inactive',date:'2025-09-12',price:45},
      {id:5,name:'عرض خاص',category:'B',status:'active',date:'2025-08-03',price:200},
      {id:6,name:'منتج نهائي',category:'C',status:'active',date:'2025-07-22',price:15}
    ];

    // عناصر DOM
    const tbody = document.querySelector('#results tbody');
    const countEl = document.getElementById('count');
    const qEl = document.getElementById('q');
    const catEl = document.getElementById('category');
    const fromDateEl = document.getElementById('fromDate');
    const toDateEl = document.getElementById('toDate');
    const minPriceEl = document.getElementById('minPrice');
    const maxPriceEl = document.getElementById('maxPrice');
    const applyBtn = document.getElementById('applyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resetBtn = document.getElementById('resetBtn');
    const exportBtn = document.getElementById('exportBtn');

    function render(rows){
      tbody.innerHTML = '';
      if(rows.length===0){
        tbody.innerHTML = '<tr><td colspan="6">لا توجد نتائج</td></tr>';
      } else {
        rows.forEach((r,i)=>{
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${i+1}</td>
            <td>${r.name}</td>
            <td>${r.category}</td>
            <td>${r.status}</td>
            <td>${r.date}</td>
            <td>${r.price}</td>
          `;
          tbody.appendChild(tr);
        });
      }
      countEl.textContent = rows.length;
    }

    function applyFilters(){
      const q = qEl.value.trim().toLowerCase();
      const cat = catEl.value;
      const minP = parseFloat(minPriceEl.value);
      const maxP = parseFloat(maxPriceEl.value);
      const from = fromDateEl.value ? new Date(fromDateEl.value) : null;
      const to = toDateEl.value ? new Date(toDateEl.value) : null;
      // حالات محددة
      const checkedStatuses = Array.from(document.querySelectorAll('input[type=checkbox]:checked')).map(i=>i.value);

      let rows = data.filter(item => {
        // بحث نصي في الاسم (أو يمكن إضافة وصف)
        if(q && !(item.name.toLowerCase().includes(q))) return false;
        if(cat && item.category !== cat) return false;
        if(checkedStatuses.length>0 && !checkedStatuses.includes(item.status)) return false;
        if(!isNaN(minP) && item.price < minP) return false;
        if(!isNaN(maxP) && item.price > maxP) return false;
        if(from && new Date(item.date) < from) return false;
        if(to && new Date(item.date) > to) return false;
        return true;
      });

      render(rows);
    }

    function clearFilters(){
      qEl.value = '';
      catEl.value = '';
      minPriceEl.value = '';
      maxPriceEl.value = '';
      fromDateEl.value = '';
      toDateEl.value = '';
      document.querySelectorAll('input[type=checkbox]').forEach(cb=>cb.checked=true);
      render(data);
    }

    function exportCSV(){
      const rows = [ ['id','name','category','status','date','price']]}